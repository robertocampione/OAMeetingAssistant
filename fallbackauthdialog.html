<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Fallback SSO</title>
    <!-- Office.js is required so we can message the parent add-in dialog -->
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <script>
      // When Microsoft redirects here, the token (or error) is in the URL hash.
      Office.onReady(function () {
        try {
          var hash = window.location.hash || "";
          if (!hash) {
            Office.context.ui.messageParent("error=NoHash");
            return;
          }
          // Send the whole fragment back; parent will parse it.
          Office.context.ui.messageParent(hash);
        } catch (e) {
          // Last-resort debug text if something very unexpected happens
          document.body.textContent = "Could not send token to parent: " + e;
        }
      });
    </script>
  </head>
  <body>Authenticating...</body>
</html>
